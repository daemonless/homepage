#!/bin/sh
# Homepage s6 service

export HOME=/config
export PATH="/usr/local/bin:/usr/bin:/bin"
export PORT="${PORT:-3000}"
export HOMEPAGE_ALLOWED_HOSTS="${HOMEPAGE_ALLOWED_HOSTS:-*}"

# Determine app directory
if [ -d /app ]; then
    APP_DIR=/app
else
    APP_DIR=/usr/local/www/homepage
fi

cd "$APP_DIR"

# Both pkg and source builds have server.js
exec /usr/local/bin/s6-setuidgid bsd /usr/local/bin/node server.js
